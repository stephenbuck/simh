#include <stdio.h>

/*
a=u=1010
b=v=1011
c=w=1100
d=x=1101
e=y=1110
f=z=1111

1414794z5v58003u9u8001x2x2000R

// Binary
1   4   1   4   7   9   4   z   5   v   5   8   0   0   3   u    9    u    8    0    0    1    x    2    x    2    0    0    0    R
0001010000010100011110010100111101011000010110000000000000111010 1001 1010 1000 0000 0000 0001 1101 0010 1101 0010 0000 0000 0000 R

// 29-bits
2         1
98765432109876543210987654321
-----------------------------
00010100000101000111100101001111 0101 1101 0101 1000 0000 1010 0011 1010 1001 1010 1000 0000 0000 0001 1101 0010 1101 0010 0000 0000 0000 R

// Instruction (binary)
IT      BN      S    C D    P
-----------------------------
00010100000101000111100101001

// Instruction (binary-split)
I T       B N       S     C  D     P
- ------- - ------- ----- -- ----- -
0 0010100 0 0010100 01111 00 10100 1

// Instruction (decimal-split)
I T   B N   S  C D  P
- --- - --- -- - -- -
0 020 0 020 31 0 20 1





   1    4    1    4    7    9    4    z    5    v    5    8    0    0    3    u    9    u    8    0    0    1    x    2    x    2    0    0    0    R
0001 0100 0001 0100 0111 1001 0100 1111 0101 1000 0101 1000 0000 0000 0011 1010 1001 1010 1000 0000 0000 0001 1101 0010 1101 0010 0000 0000 0000 R

Word #1

2           1
9876 5432 1098 7654 3210 9876 5432 1
---- ---- ---- ---- ---- ---- ---- -
0001 0100 0001 0100 0111 1001 0100 1111 0101 1101 0101 1000 0000 1010 0011 1010 1001 1010 1000 0000 0000 0001 1101 0010 1101 0010 0000 0000 0000 R

? TIME    NEXT    DST   SRC   CH B S
- ------- ------- ----- ----- -- - -
0 
Word #2
2           1
9876 5432 1098 7654 3210 9876 5432 1
---- ---- ---- ---- ---- ---- ---- -
0001 0100 0001 0100 0111 1001 0100 1111 0101 1101 0101 1000 0000 1010 0011 1010 1001 1010 1000 0000 0000 0001 1101 0010 1101 0010 0000 0000 0000 R
*/

static void print_inst(uint8_t l_w uint32_t inst)
{
    i_I = (inst & 0b10000000000000000000000000000000) >> 31;
    i_T = (inst & 0b01111111000000000000000000000000) >> 24;
    i_B = (inst & 0b00000000100000000000000000000000) >> 23;
    i_N = (inst & 0b00000000011111110000000000000000) >> 16;
    i_C = (inst & 0b00000000000000001100000000000000) >> 14;
    i_S = (inst & 0b00000000000000000011111000000000) >>  9;
    i_D = (inst & 0b00000000000000000000000111110000) >>  4;
    i_P = (inst & 0b00000000000000000000000000001000) >>  3;

    printf("%1s %3s %1s %3s %1s %2s %2s %1s\n", "(L:W)", "I", "T  ", "B", "N  ", "C", "S ", "D ", "P");
    printf("%1s %3s %1s %3s %1s %2s %2s %1s\n", "_____", "_", "___", "_", "___", "_", "__", "__", "_");
    printf("%1u %3u %1u %3u %1u %2u %2u %1u\n", l_w,     i_I, i_T,   i_B, i_N,   i_C, i_S,  i_D,  i_P);
}

int main(int argc, char *argv[])
{
    char * name = "diaper_reel1.pti";
    FILE * file = fopen(name, "r");
    if (file == NULL)
    {
        printf("Can't open '%s'\n", name);
        return 1;
    }
    int c;
    while ((c = fgetc(file)) != EOF)
    {
//        putchar(c);
        int n;
        switch (c)
        {
            case '0':
            case '1':
            case '2':
            case '3':
            case '4':
            case '5':
            case '6':
            case '7':
            case '8':
            case '9':
                n = c - '0';
                printf("<DIGIT: %x>\n", n);
                break;
            case 'u':
            case 'v':
            case 'w':
            case 'x':
            case 'y':
            case 'z':
                n = c - 'u' + 10;
                printf("<LETTER: %x>\n", n);
                break;
            case 'D':
                printf("<CR>\n");
                break;
            case 'R':
            case '/':
                printf("<RELOAD>\n\n");
                break;
            case 'S':
                printf("<STOP>\n");
                break;
            case 'T':
                printf("<TAB>\n");
                break;
            case 'W':
                printf("<WAIT>\n");
                break;
            case '.':
                printf("<PERIOD>\n");
                break;
            default:
                break;
        }
    }
    return 0;
}
    