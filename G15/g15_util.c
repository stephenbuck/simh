#include "g15_defs.h"
#include <ctype.h>

uint32_t g15_util_i2w(G15_INST inst)
{
    return
        inst.P << 27 |
        inst.L << 20 |
        inst.N << 13 |
        inst.C << 11 |
        inst.S <<  6 |
        inst.D <<  1 |
        0;
}

G15_INST g15_util_w2i(unsigned word)
{
    G15_INST inst =
    {
        P: (word & 0b00001000000000000000000000000000) >> 27,
        L: (word & 0b00000111111100000000000000000000) >> 20,
        N: (word & 0b00000000000011111110000000000000) >> 13,
        C: (word & 0b00000000000000000001100000000000) >> 11,
        S: (word & 0b00000000000000000000011111000000) >> 6,
        D: (word & 0b00000000000000000000000000111110) >> 1,
    };
    return inst;
}

void g15_util_trace_enter(const char * context)
{
    printf("%s\n", context);
    printf("{\n");
}

void g15_util_trace_leave()
{
    printf("}\n");
}

void g15_util_trace_print(const char * message)
{
}

#if 0
const int32 flex_to_ascii[128] =
{
    -1  , 'z', '0', ' ', '>', 'b', '1', '-',
    '<' , 'y', '2', '+', '|', 'r', '3', ';',
    '\r', 'i', '4', '/','\\', 'd', '5', '.',
    '\t', 'n', '6', ',', -1 , 'm', '7', 'v',
    '\'', 'p', '8', 'o', -1 , 'e', '9', 'x',
    -1  , 'u', 'f', -1 , -1 , 't', 'g', -1 ,
    -1  , 'h', 'j', -1 , -1 , 'c', 'k', -1 ,
    -1  , 'a', 'q', -1 , -1 , 's', 'w', 0  ,

    -1  , 'Z', ')', ' ', -1 , 'B', 'L', '_',
    -1  , 'Y', '*', '=', '|', 'R', '"', ':',
    '\r', 'I', '^', '?','\\', 'D', '%', ']',
    '\t', 'N', '$', '[', -1 , 'M', '~', 'V',
    '\'', 'P', '#', 'O', -1 , 'E', '(', 'X',
    -1  , 'U', 'F', -1 , -1 , 'T', 'G', -1 ,
    -1  , 'H', 'J', -1 , -1 , 'C', 'K', -1 ,
    -1  , 'A', 'Q', -1 , -1 , 'S', 'W', 0
};

const int32 ascii_to_flex[128] =
{
    -1 , -1 , -1 , -1 , -1 , -1 , -1 , -1 ,
    024, 030, -1 , -1 , -1 , 020, -1 , -1 ,
    -1 , -1 , -1 , -1 , -1 , -1 , -1 , -1 ,
    -1 , -1 , -1 , -1 , -1 , -1 , -1 , -1 ,
    003, -1 , 016, 042, 032, 026, -1 , 040,
    046, 001, 012, 013, 033, 007, 027, 023,
    002, 006, 012, 016, 022, 026, 032, 036,
    042, 046, 017, 017, 004, 013, 010, 023,
    -1 , 071, 005, 065, 025, 045, 052, 056,
    061, 021, 062, 066, 006, 035, 031, 043,
    041, 072, 015, 075, 055, 051, 037, 076,
    047, 011, 001, 033, -1 , 027, 022, 007,
    -1,  071, 005, 065, 025, 045, 052, 056,
    061, 021, 062, 066, 006, 035, 031, 043,
    041, 072, 015, 075, 055, 051, 037, 076,
    047, 011, 001, -1 , 014, -1 , 036, 077
};
    
static const uint8 flex_inp_valid[64] =
{
    1, 1, 1, 1, 0, 1, 1, 1,
    0, 1, 1, 1, 0, 1, 1, 1,
    0, 1, 1, 1, 0, 1, 1, 1,
    0, 1, 1, 1, 0, 1, 1, 1,
    1, 1, 1, 1, 0, 1, 1, 1,
    0, 1, 1, 1, 0, 1, 1, 1,
    0, 1, 1, 1, 0, 1, 1, 1,
    0, 1, 1, 1, 0, 1, 1, 1
};
#endif